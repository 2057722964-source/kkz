<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>给特别的你</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
       
        body {
            font-family: 'Microsoft YaHei', sans-serif;
            background: linear-gradient(135deg, #fff5f5 0%, #ffeef2 100%);
            overflow: hidden;
            height: 100vh;
            width: 100vw;
            position: relative;
            color: #ff6b93;
            cursor: pointer;
            transition: background-color 1s ease;
        }
       
        #container {
            position: relative;
            width: 100%;
            height: 100%;
        }
       
        #cat {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-family: 'Courier New', monospace;
            font-weight: bold;
            white-space: pre;
            text-align: center;
            z-index: 10;
            transition: all 1s ease;
            font-size: min(4vw, 24px);
            line-height: 1.2;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
            animation: float 3s ease-in-out infinite;
        }
        
        @keyframes float {
            0%, 100% { transform: translate(-50%, -50%); }
            50% { transform: translate(-50%, -55%); }
        }
       
        .floating-text {
            position: absolute;
            font-size: min(3vw, 20px);
            font-weight: bold;
            color: #ff6b93;
            text-align: center;
            opacity: 0;
            transition: opacity 0.5s ease, transform 0.5s ease;
            padding: min(2vw, 15px) min(3vw, 25px);
            border-radius: 15px;
            max-width: min(80vw, 400px);
            word-wrap: break-word;
            pointer-events: none;
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(5px);
            box-shadow: 0 4px 15px rgba(255, 107, 147, 0.2);
            border: 1px solid rgba(255, 107, 147, 0.3);
            animation: textFloat 4s ease-in-out infinite;
            z-index: 5;
        }
        
        @keyframes textFloat {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }
       
        #question-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: none;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 20;
            background-color: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            animation: fadeIn 1s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
       
        #question {
            font-size: min(5vw, 36px);
            font-weight: bold;
            margin-bottom: min(5vh, 50px);
            text-align: center;
            padding: 0 20px;
            color: #ff6b93;
            text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.1);
        }
       
        .buttons {
            display: flex;
            gap: min(4vw, 30px);
            margin-top: min(4vh, 30px);
            flex-wrap: wrap;
            justify-content: center;
        }
       
        .btn {
            padding: min(2vh, 15px) min(4vw, 40px);
            font-size: min(3vw, 28px);
            font-weight: bold;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            color: white;
            background: linear-gradient(135deg, #ff6b93 0%, #ff8fa3 100%);
            min-width: min(30vw, 150px);
            box-shadow: 0 4px 15px rgba(255, 107, 147, 0.3);
            position: relative;
            overflow: hidden;
        }
        
        .btn::after {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            transition: left 0.5s;
        }
       
        .btn:hover {
            transform: scale(1.05);
            box-shadow: 0 6px 20px rgba(255, 107, 147, 0.4);
        }
        
        .btn:hover::after {
            left: 100%;
        }
       
        #music-toggle {
            position: absolute;
            top: 20px;
            left: 20px;
            padding: 12px 18px;
            background: linear-gradient(135deg, #ff6b93 0%, #ff8fa3 100%);
            color: white;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            z-index: 30;
            font-size: 16px;
            box-shadow: 0 4px 10px rgba(255, 107, 147, 0.3);
            transition: all 0.3s ease;
            min-width: 120px;
        }
        
        #music-toggle:hover {
            transform: scale(1.05);
        }
       
        #click-hint {
            position: absolute;
            bottom: 20px;
            left: 20px;
            color: #ff6b93;
            font-size: min(2vw, 14px);
            z-index: 30;
            background: rgba(255, 255, 255, 0.8);
            padding: 8px 15px;
            border-radius: 20px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 0.7; }
            50% { opacity: 1; }
        }

        #loading-message {
            position: absolute;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            color: #ff6b93;
            font-size: min(2.5vw, 16px);
            z-index: 30;
            display: none;
            background: white;
            padding: 10px 20px;
            border-radius: 50px;
            border: 1px solid #ff6b93;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
        }

        #error-message {
            position: absolute;
            top: 60px;
            left: 50%;
            transform: translateX(-50%);
            color: #ff6b6b;
            font-size: min(2.5vw, 14px);
            z-index: 30;
            display: none;
            background: rgba(255, 255, 255, 0.95);
            padding: 10px 20px;
            border-radius: 50px;
            border: 1px solid #ff6b6b;
            text-align: center;
            max-width: 90vw;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
        }

        .custom-alert {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            padding: min(4vw, 30px);
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(255, 107, 147, 0.3);
            text-align: center;
            z-index: 1000;
            border: 3px solid #ff6b93;
            min-width: min(80vw, 300px);
            max-width: 90vw;
            animation: popIn 0.5s ease;
        }
        
        @keyframes popIn {
            0% { transform: translate(-50%, -50%) scale(0.5); opacity: 0; }
            100% { transform: translate(-50%, -50%) scale(1); opacity: 1; }
        }
       
        .custom-alert h3 {
            color: #ff6b93;
            margin-bottom: 15px;
            font-size: min(4vw, 24px);
        }
       
        .custom-alert p {
            color: #666;
            margin-bottom: 20px;
            font-size: min(3vw, 18px);
        }
       
        .custom-alert button {
            background: linear-gradient(135deg, #ff6b93 0%, #ff8fa3 100%);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 50px;
            cursor: pointer;
            font-size: min(2.5vw, 16px);
            box-shadow: 0 4px 10px rgba(255, 107, 147, 0.3);
            transition: all 0.3s ease;
        }
        
        .custom-alert button:hover {
            transform: scale(1.05);
        }

        .heart {
            position: absolute;
            width: 20px;
            height: 20px;
            background: #ff6b93;
            transform: rotate(45deg);
            opacity: 0;
            pointer-events: none;
            z-index: 5;
        }
        
        .heart:before, .heart:after {
            content: '';
            width: 20px;
            height: 20px;
            background: #ff6b93;
            border-radius: 50%;
            position: absolute;
        }
        
        .heart:before {
            top: -10px;
            left: 0;
        }
        
        .heart:after {
            top: 0;
            left: -10px;
        }

        @media (max-width: 768px) {
            .buttons {
                flex-direction: column;
                align-items: center;
            }
           
            .btn {
                width: min(60vw, 200px);
            }
           
            #cat {
                font-size: min(5vw, 20px);
            }
            
            #music-toggle {
                top: 15px;
                left: 15px;
                font-size: 14px;
                padding: 10px 15px;
                min-width: 100px;
            }
            
            #click-hint {
                bottom: 15px;
                left: 15px;
                font-size: 14px;
            }
        }

        @media (max-width: 480px) {
            #question {
                font-size: min(6vw, 28px);
            }
           
            #cat {
                font-size: min(6vw, 18px);
            }
            
            #music-toggle {
                top: 10px;
                left: 10px;
                font-size: 12px;
                padding: 8px 12px;
                min-width: 90px;
            }
            
            #click-hint {
                bottom: 10px;
                left: 10px;
                font-size: 12px;
            }
        }
    </style>
</head>
<body>
    <div id="container">
        <pre id="cat">           /\_/\  
          ( o.o )
           > ^ <  </pre>
       
        <div id="question-container">
            <div id="question">能不能请你做我的对象？</div>
            <div class="buttons">
                <button id="yes-btn" class="btn">愿意</button>
                <button id="no-btn" class="btn">不愿意</button>
            </div>
        </div>
       
        <button id="music-toggle">🔇 播放音乐</button>
        <div id="click-hint">点击页面任意位置开始体验</div>
        <div id="loading-message">音乐加载中...</div>
        <div id="error-message"></div>
       
        <!-- 使用您最初提供的GitHub音乐链接 -->
        <audio id="background-music" loop preload="metadata">
            <source src="https://raw.githubusercontent.com/2057722964-source/kkz/main/gift.mp3" type="audio/mpeg">
            您的浏览器不支持音频元素。
        </audio>
    </div>

    <script>
        // 句子列表 - 原有20句 + 新增30句一见钟情主题
        const sentences = [
            // 原有20句
            "我喜欢你，也喜欢你不注意我时的样子。",
            "与你对话前，我练习了许多遍开场白。",
            "你笑起来的样子，比台灯更安稳。",
            "我想送你一杯热茶，暖你一天的冷风。",
            "你走近时，我甚至连呼吸都想对你谦让。",
            "日子有风也好，有雨也好，只要有你在，我就安静。",
            "你的名字，是我所有笔记里最想写的一行。",
            "我不是你轰轰烈烈的故事，只是你平淡日里的温柔。",
            "我习惯了在朋友圈里喜欢你，但从不点赞。",
            "你不知道，那些我假装无事的笑，是为你保留的。",
            "偶然和你擦肩，是我心里开花的瞬间。",
            "我想和你聊的不只是天气，还有你没说出口的愿望。",
            "喜欢一个人，就是明知道走不进去，却还想走近。",
            "你在我身边时，天空仿佛安静了下来。",
            "我愿意做你看不到的那个人，却一直在你身边。",
            "我的世界不大，但装你正好。",
            "你若发光，我就在旁边戴墨镜欣赏。",
            "我不急于表白，只想做你生活里的一颗小安定。",
            "每次见到你，我都很想问一句：你刚好好吗？",
            "我喜欢你，就像喜欢冬天的暖阳，悄悄地来了。",
            
            // 新增30句一见钟情主题的浪漫语句
            "第一次见到你，我的心跳就漏了一拍。",
            "从遇见你的那一刻起，我的世界就变了颜色。",
            "你的出现，像一道光照亮了我平淡的生活。",
            "第一眼见到你，我就知道这是命中注定。",
            "你的笑容让我瞬间明白了什么是一见钟情。",
            "在人群中，我第一眼就看到了闪闪发光的你。",
            "遇见你的瞬间，时间仿佛都停止了。",
            "你的眼神让我第一次相信了一见钟情。",
            "从见到你的第一面起，我的目光就无法从你身上移开。",
            "你的存在，让我相信这世上真的有命中注定。",
            "第一眼看到你，我的心就告诉我要靠近你。",
            "你的出现，让我的世界瞬间变得完整。",
            "从遇见你开始，我的心里就再也装不下别人。",
            "你的气质让我在第一眼就被深深吸引。",
            "见到你的那一刻，我就知道你是特别的人。",
            "你的声音让我第一次体会到心动的感觉。",
            "从第一眼开始，你就住进了我的心里。",
            "你的微笑让我瞬间忘记了所有的烦恼。",
            "遇见你，是我生命中最美好的意外。",
            "第一眼见到你，我就想认识你更多。",
            "你的存在让我相信了一见钟情的魔力。",
            "从见到你的第一刻起，我就知道我们会有一段故事。",
            "你的眼神让我第一次体会到什么是心动。",
            "遇见你的瞬间，我就知道你是对的人。",
            "你的气质让我在第一眼就被深深打动。",
            "从第一眼开始，我就想守护你的笑容。",
            "你的出现，让我明白了什么是命中注定。",
            "见到你的那一刻，我的世界都亮了起来。",
            "你的微笑让我第一次相信了一见钟情。",
            "从遇见你开始，我的心里就只有你一个人。"
        ];

        // 小猫状态
        const catStates = {
            normal: "           /\\_/\\  \n          ( o.o ) \n           > ^ <  ",
            blink: "           /\\_/\\  \n          ( -.- ) \n           > ^ <  ",
            sad: "           /\\_/\\  \n          ( T.T ) \n           > ^ <  ",
            happy: "           /\\_/\\  \n          ( ^.^ ) \n           > ^ <  "
        };

        // 全局变量
        let displayedSentences = 0;
        let noButtonClicks = 0;
        let backgroundMusic;
        let isMusicPlaying = false;
        let userInteracted = false;
        let musicLoaded = false;
        let heartsInterval;
        let catBlinkInterval;
        let musicLoadTimeout;

        // 初始化
        document.addEventListener('DOMContentLoaded', function() {
            initializeApp();
        });

        // 初始化应用
        function initializeApp() {
            // 获取音频元素
            backgroundMusic = document.getElementById('background-music');
           
            // 设置音乐事件监听
            setupMusicEvents();
           
            // 随机打乱句子顺序
            shuffleArray(sentences);
           
            // 设置用户交互监听
            setupUserInteraction();
           
            // 设置按钮事件
            document.getElementById('yes-btn').addEventListener('click', onYesClicked);
            document.getElementById('no-btn').addEventListener('click', onNoClicked);
            document.getElementById('music-toggle').addEventListener('click', toggleMusic);
           
            // 预加载音乐
            preloadMusic();
           
            // 初始调整布局
            adjustLayout();
        }

        // 调整布局
        function adjustLayout() {
            const cat = document.getElementById('cat');
           
            // 确保小猫完整显示
            const catWidth = cat.offsetWidth;
            const catHeight = cat.offsetHeight;
           
            if (catWidth > window.innerWidth * 0.8 || catHeight > window.innerHeight * 0.8) {
                cat.style.fontSize = Math.min(
                    window.innerWidth * 0.03,
                    window.innerHeight * 0.05,
                    24
                ) + 'px';
            }
        }

        // 设置音乐事件监听
        function setupMusicEvents() {
            backgroundMusic.addEventListener('loadstart', function() {
                showLoading('音乐加载中...');
                // 设置3秒超时自动切换备用音乐
                musicLoadTimeout = setTimeout(() => {
                    if (!musicLoaded) {
                        switchToBackupMusic();
                    }
                }, 3000);
            });
           
            backgroundMusic.addEventListener('canplay', function() {
                clearTimeout(musicLoadTimeout);
                hideLoading();
                musicLoaded = true;
                showError('音乐加载成功！点击播放按钮开始播放', 'success');
            });
           
            backgroundMusic.addEventListener('canplaythrough', function() {
                clearTimeout(musicLoadTimeout);
                hideLoading();
                musicLoaded = true;
            });
           
            backgroundMusic.addEventListener('error', function(e) {
                clearTimeout(musicLoadTimeout);
                hideLoading();
                musicLoaded = false;
                switchToBackupMusic();
            });
        }

        // 切换到备用音乐
        function switchToBackupMusic() {
            showError('正在切换到备用音乐...');
            // 使用可靠的备用音乐URL
            backgroundMusic.src = "https://cdn.pixabay.com/download/audio/2022/11/02/audio_eb11f97d98.mp3?filename=soft-piano-ambient-184253.mp3";
            backgroundMusic.load();
        }

        // 预加载音乐
        function preloadMusic() {
            backgroundMusic.volume = 0.5;
            // 使用更可靠的方式加载音乐
            setTimeout(() => {
                backgroundMusic.load();
            }, 500);
        }

        // 显示加载信息
        function showLoading(message) {
            const loadingDiv = document.getElementById('loading-message');
            loadingDiv.textContent = message;
            loadingDiv.style.display = 'block';
        }

        // 隐藏加载信息
        function hideLoading() {
            document.getElementById('loading-message').style.display = 'none';
        }

        // 显示错误信息
        function showError(message, type = 'error') {
            const errorDiv = document.getElementById('error-message');
            errorDiv.textContent = message;
            errorDiv.style.display = 'block';
            errorDiv.style.borderColor = type === 'success' ? '#4CAF50' : '#ff6b6b';
            errorDiv.style.color = type === 'success' ? '#4CAF50' : '#ff6b6b';
           
            setTimeout(() => {
                errorDiv.style.display = 'none';
            }, 3000);
        }

        // 设置用户交互监听
        function setupUserInteraction() {
            document.body.addEventListener('click', function(e) {
                if (!userInteracted) {
                    userInteracted = true;
                    document.getElementById('click-hint').style.display = 'none';
                    
                    startShowingSentences();
                    startCatBlinking();
                    createHeart(e.clientX, e.clientY);
                } else {
                    createHeart(e.clientX, e.clientY);
                }
            });

            // 窗口大小变化时重新调整布局
            window.addEventListener('resize', function() {
                adjustLayout();
                if (document.getElementById('question-container').style.display === 'flex') {
                    showQuestion();
                }
            });
        }

        // 创建爱心效果
        function createHeart(x, y) {
            const heart = document.createElement('div');
            heart.className = 'heart';
            heart.style.left = (x - 10) + 'px';
            heart.style.top = (y - 10) + 'px';
            document.body.appendChild(heart);
            
            // 爱心动画
            const size = Math.random() * 10 + 10;
            heart.style.width = size + 'px';
            heart.style.height = size + 'px';
            
            setTimeout(() => {
                heart.style.opacity = '1';
                heart.style.transform = `rotate(45deg) translateY(-${Math.random() * 100 + 50}px)`;
                heart.style.opacity = '0';
                
                setTimeout(() => {
                    if (heart.parentNode) {
                        heart.parentNode.removeChild(heart);
                    }
                }, 1000);
            }, 10);
        }

        // 打乱数组
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
        }

        // 开始显示句子
        function startShowingSentences() {
            const interval = setInterval(() => {
                if (displayedSentences < sentences.length) {
                    createFloatingText(sentences[displayedSentences]);
                    displayedSentences++;
                } else {
                    clearInterval(interval);
                    setTimeout(showQuestion, 1000);
                }
            }, 800);
        }

        // 创建浮动文本
        function createFloatingText(text) {
            const container = document.getElementById('container');
            const textElement = document.createElement('div');
            textElement.className = 'floating-text';
            textElement.textContent = text + "  (=^･ω･^=)";
           
            // 更好的位置计算，完全避开小猫区域
            const catRect = document.getElementById('cat').getBoundingClientRect();
            const safeMargin = 120; // 增加安全边距
           
            const catArea = {
                left: catRect.left - safeMargin,
                top: catRect.top - safeMargin,
                right: catRect.right + safeMargin,
                bottom: catRect.bottom + safeMargin
            };
           
            let attempts = 0;
            let x, y;
            do {
                x = Math.random() * (window.innerWidth - 300) + 50;
                y = Math.random() * (window.innerHeight - 150) + 50;
                attempts++;
                if (attempts > 100) {
                    // 如果尝试次数过多，强制放在屏幕边缘
                    const edges = [
                        { x: 50, y: Math.random() * (window.innerHeight - 150) + 50 }, // 左边缘
                        { x: window.innerWidth - 300, y: Math.random() * (window.innerHeight - 150) + 50 }, // 右边缘
                        { x: Math.random() * (window.innerWidth - 300) + 50, y: 50 }, // 上边缘
                        { x: Math.random() * (window.innerWidth - 300) + 50, y: window.innerHeight - 150 } // 下边缘
                    ];
                    const edgePos = edges[Math.floor(Math.random() * edges.length)];
                    x = edgePos.x;
                    y = edgePos.y;
                    break;
                }
            } while (
                x > catArea.left && x < catArea.right &&
                y > catArea.top && y < catArea.bottom
            );
           
            textElement.style.left = `${x}px`;
            textElement.style.top = `${y}px`;
            container.appendChild(textElement);
           
            // 淡入淡出动画
            setTimeout(() => {
                textElement.style.opacity = '1';
                textElement.style.transform = 'translateY(-10px)';
            }, 10);
            
            setTimeout(() => {
                textElement.style.opacity = '0';
                textElement.style.transform = 'translateY(-30px)';
                setTimeout(() => {
                    if (textElement.parentNode) {
                        container.removeChild(textElement);
                    }
                }, 500);
            }, 3000);
        }

        // 小猫眨眼动画
        function startCatBlinking() {
            // 清除之前的间隔（如果有）
            if (catBlinkInterval) {
                clearInterval(catBlinkInterval);
            }
            
            catBlinkInterval = setInterval(() => {
                const cat = document.getElementById('cat');
                if (cat.textContent === catStates.normal &&
                    document.getElementById('question-container').style.display !== 'flex') {
                    cat.textContent = catStates.blink;
                    setTimeout(() => {
                        if (cat.textContent === catStates.blink) {
                            cat.textContent = catStates.normal;
                        }
                    }, 200);
                }
            }, 2000);
        }

        // 显示问题
        function showQuestion() {
            const cat = document.getElementById('cat');
            const questionContainer = document.getElementById('question-container');
           
            // 停止眨眼动画
            if (catBlinkInterval) {
                clearInterval(catBlinkInterval);
            }
           
            // 移动小猫到上方
            const catX = window.innerWidth / 2;
            const catY = Math.min(100, window.innerHeight * 0.1);
           
            cat.style.left = `${catX}px`;
            cat.style.top = `${catY}px`;
            cat.style.transform = 'translateX(-50%)';
            cat.style.fontSize = Math.min(window.innerWidth * 0.03, 20) + 'px';
            cat.style.textAlign = 'center';
           
            // 显示问题
            questionContainer.style.display = 'flex';
            cat.style.zIndex = '25';
            
            // 开始爱心雨
            startHeartRain();
        }
        
        // 开始爱心雨
        function startHeartRain() {
            heartsInterval = setInterval(() => {
                const x = Math.random() * window.innerWidth;
                createHeart(x, -20);
            }, 300);
        }

        // 愿意按钮点击事件
        function onYesClicked() {
            const cat = document.getElementById('cat');
            cat.textContent = catStates.happy;
            
            // 停止爱心雨
            clearInterval(heartsInterval);
            
            // 增加爱心效果
            for (let i = 0; i < 20; i++) {
                setTimeout(() => {
                    const x = Math.random() * window.innerWidth;
                    const y = Math.random() * window.innerHeight;
                    createHeart(x, y);
                }, i * 100);
            }
           
            setTimeout(() => {
                showCustomAlert();
            }, 1500);
        }

        // 显示自定义弹窗
        function showCustomAlert() {
            const alertDiv = document.createElement('div');
            alertDiv.className = 'custom-alert';
            alertDiv.innerHTML = `
                <h3>🎉 太棒了！</h3>
                <p>太好了！谢谢你愿意！</p>
                <p><small>页面将在3秒后自动关闭...</small></p>
                <button onclick="closePage()">立即关闭</button>
            `;
            document.body.appendChild(alertDiv);
            setTimeout(closePage, 3000);
        }

        // 关闭页面函数
        function closePage() {
            stopMusic();
            setTimeout(() => {
                window.close();
                setTimeout(() => {
                    window.location.href = 'about:blank';
                }, 100);
            }, 500);
        }

        // 不愿意按钮点击事件
        function onNoClicked() {
            noButtonClicks++;
            const noBtn = document.getElementById('no-btn');
            const yesBtn = document.getElementById('yes-btn');
            const cat = document.getElementById('cat');
           
            cat.textContent = catStates.sad;
           
            if (noButtonClicks >= 3) {
                noBtn.style.display = 'none';
                // 修改为新的提示语
                showError('真的不能考虑考虑吗，真的很认真的！', 'error');
            } else {
                const currentScale = Math.pow(0.7, noButtonClicks);
                const yesScale = Math.pow(1.3, noButtonClicks);
                noBtn.style.transform = `scale(${currentScale})`;
                yesBtn.style.transform = `scale(${yesScale})`;
            }
        }

        // 播放音乐
        function playMusic() {
            if (backgroundMusic && musicLoaded) {
                showLoading('准备播放音乐...');
               
                const playPromise = backgroundMusic.play();
               
                if (playPromise !== undefined) {
                    playPromise.then(() => {
                        isMusicPlaying = true;
                        document.getElementById('music-toggle').innerHTML = '🔊 停止音乐';
                        hideLoading();
                        showError('音乐播放成功！', 'success');
                    }).catch(error => {
                        hideLoading();
                        showError('播放失败: 请点击页面任意位置后重试');
                        isMusicPlaying = false;
                    });
                }
            } else {
                showError('音乐尚未加载完成，请稍后重试');
            }
        }

        // 切换音乐
        function toggleMusic() {
            if (!isMusicPlaying) {
                playMusic();
            } else {
                stopMusic();
            }
        }

        // 停止音乐
        function stopMusic() {
            if (backgroundMusic) {
                backgroundMusic.pause();
                backgroundMusic.currentTime = 0;
            }
            isMusicPlaying = false;
            document.getElementById('music-toggle').innerHTML = '🔇 播放音乐';
        }

        // 使函数在全局可访问
        window.closePage = closePage;
    </script>
</body>
</html>
